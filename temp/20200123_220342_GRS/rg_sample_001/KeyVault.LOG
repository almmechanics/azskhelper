================================================================================
Starting analysis: [FeatureName: KeyVault] [ResourceGroupName: rg_sample_001] [ResourceName: kv001demo001] 
--------------------------------------------------------------------------------
================================================================================
[Azure_KeyVault_AuthN_Use_Cert_Auth_for_Apps]: Azure Active Directory applications, which have access to Key Vault, must use certificate to authenticate to Key Vault
--------------------------------------------------------------------------------
01/23/2020 22:05:12-Checking: [KeyVault]-[Azure Active Directory applications, which have access to Key Vault, must use certificate to authenticate to Key Vault] for resource [kv001demo001]
No Azure AD Applications have access to Key Vault.
--------------------------------------------------------------------------------
**Passed**: [KeyVault]-[Azure Active Directory applications, which have access to Key Vault, must use certificate to authenticate to Key Vault] for resource: [kv001demo001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_KeyVault_AuthN_Dont_Share_KeyVault_Unless_Trust]: Applications must not share a Key Vault unless they trust each other and they need access to the same secrets at runtime
--------------------------------------------------------------------------------
01/23/2020 22:05:13-Checking: [KeyVault]-[Applications must not share a Key Vault unless they trust each other and they need access to the same secrets at runtime] for resource [kv001demo001]
No Azure AD Applications have access to Key Vault.
--------------------------------------------------------------------------------
**Passed**: [KeyVault]-[Applications must not share a Key Vault unless they trust each other and they need access to the same secrets at runtime] for resource: [kv001demo001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_KeyVault_AuthZ_Grant_Min_RBAC_Access]: All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)
--------------------------------------------------------------------------------
01/23/2020 22:05:13-Checking: [KeyVault]-[All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)] for resource [kv001demo001]
No identities have been explicitly provided with RBAC access to resource - [kv001demo001]
Note: 4 identities (ServicePrincipal: 3, User: 1) have inherited RBAC access to resource. It's good practice to keep the RBAC access to minimum.
--------------------------------------------------------------------------------
**Verify**: [KeyVault]-[All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)] for resource: [kv001demo001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_KeyVault_AuthZ_Grant_Min_Access_policies]: All Key Vault access policies must be defined with minimum required permissions to keys and secrets
--------------------------------------------------------------------------------
01/23/2020 22:05:14-Checking: [KeyVault]-[All Key Vault access policies must be defined with minimum required permissions to keys and secrets] for resource [kv001demo001]
Validate access policies and their assigned permissions to Key/Secret/Certificate - [kv001demo001]
--------------------------------------------------------------------------------
**Verify**: [KeyVault]-[All Key Vault access policies must be defined with minimum required permissions to keys and secrets] for resource: [kv001demo001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_KeyVault_AuthZ_Configure_Advanced_Access_Policies]: Advanced access policies must be configured on a need basis
--------------------------------------------------------------------------------
01/23/2020 22:05:15-Checking: [KeyVault]-[Advanced access policies must be configured on a need basis] for resource [kv001demo001]
All Advanced Access Policies are disabled - [kv001demo001]
@{
    "Enable access to Azure Resource Manager for template deployment" = $False; 
    "Enable access to Azure Disk Encryption for volume encryption" = $False; 
    "Enable access to Azure Virtual Machines for deployment" = $False
}
--------------------------------------------------------------------------------
**Passed**: [KeyVault]-[Advanced access policies must be configured on a need basis] for resource: [kv001demo001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_KeyVault_DP_Keys_Protect_By_HSM]: All Keys in Key Vault must be protected by HSM [Key Type = HSM Protected Key]
--------------------------------------------------------------------------------
01/23/2020 22:05:15-Checking: [KeyVault]-[All Keys in Key Vault must be protected by HSM [Key Type = HSM Protected Key]] for resource [kv001demo001]
Control can not be validated due to insufficient access permission on keys
--------------------------------------------------------------------------------
**Manual**: [KeyVault]-[All Keys in Key Vault must be protected by HSM [Key Type = HSM Protected Key]] for resource: [kv001demo001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_KeyVault_DP_Keys_Secrets_Check_Expiry_Date]: All Keys and Secrets in Key Vault must have expiration dates
--------------------------------------------------------------------------------
01/23/2020 22:05:15-Checking: [KeyVault]-[All Keys and Secrets in Key Vault must have expiration dates] for resource [kv001demo001]
Control can not be validated due to insufficient access permission on KeyVault keys or secrets
--------------------------------------------------------------------------------
**Manual**: [KeyVault]-[All Keys and Secrets in Key Vault must have expiration dates] for resource: [kv001demo001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_KeyVault_Audit_Enable_Diagnostics_Log]: Diagnostics logs must be enabled with a retention period of at least 365 days.
--------------------------------------------------------------------------------
01/23/2020 22:05:15-Checking: [KeyVault]-[Diagnostics logs must be enabled with a retention period of at least 365 days.] for resource [kv001demo001]
Diagnostics setting is disabled for resource - [kv001demo001].
--------------------------------------------------------------------------------
**Failed**: [KeyVault]-[Diagnostics logs must be enabled with a retention period of at least 365 days.] for resource: [kv001demo001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_KeyVault_AuthN_Key_Min_Operation]: Restrict the cryptographic operations permitted using keys to the ones actually required
--------------------------------------------------------------------------------
01/23/2020 22:05:16-Checking: [KeyVault]-[Restrict the cryptographic operations permitted using keys to the ones actually required] for resource [kv001demo001]
Control can not be validated due to insufficient access permission on keys
--------------------------------------------------------------------------------
**Manual**: [KeyVault]-[Restrict the cryptographic operations permitted using keys to the ones actually required] for resource: [kv001demo001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_KeyVault_SI_Enable_SoftDelete]: Soft delete must be enabled to allow recovery of deleted Key Vault and any objects (keys, secrets, etc.) contained in it.
--------------------------------------------------------------------------------
01/23/2020 22:05:16-Checking: [KeyVault]-[Soft delete must be enabled to allow recovery of deleted Key Vault and any objects (keys, secrets, etc.) contained in it.] for resource [kv001demo001]
Soft delete is disabled for this Key Vault
--------------------------------------------------------------------------------
**Failed**: [KeyVault]-[Soft delete must be enabled to allow recovery of deleted Key Vault and any objects (keys, secrets, etc.) contained in it.] for resource: [kv001demo001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_KeyVault_Avoid_Excessive_Versions_Keys_Secrets]: Too many versions of keys or secrets should not be in use.
--------------------------------------------------------------------------------
01/23/2020 22:05:17-Checking: [KeyVault]-[Too many versions of keys or secrets should not be in use.] for resource [kv001demo001]
Number of keys can not be validated due to insufficient access permission on keys
Access denied: Read access is required on Key Vault Secrets to validate the number of secrets.
Access denied: Read access is required on Key Vault Secrets and Keys to validate the number of secrets and keys.
--------------------------------------------------------------------------------
**Manual**: [KeyVault]-[Too many versions of keys or secrets should not be in use.] for resource: [kv001demo001]
--------------------------------------------------------------------------------
================================================================================ 

--------------------------------------------------------------------------------
Completed analysis: [FeatureName: KeyVault] [ResourceGroupName: rg_sample_001] [ResourceName: kv001demo001] 
================================================================================
################################################################################
