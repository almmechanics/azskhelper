"ControlID","Status","FeatureName","ResourceGroupName","ResourceName","ControlSeverity","IsBaselineControl","IsPreviewBaselineControl","IsControlInGrace","SupportsAutoFix","Description","Recommendation","ResourceId","DetailedLogFile"
"Azure_Storage_AuthN_Dont_Allow_Anonymous","Passed","Storage","apimdemo01_rg","fnapimdemo01dev","High","Yes","No","No","Yes","The Access Type for containers must not be set to 'Anonymous'","Run command 'Set-AzStorageContainerAcl -Name '<ContainerName>' -Permission 'Off' -Context (New-AzStorageContext -StorageAccountName '<StorageAccountName>' -StorageAccountKey '<StorageAccountKey>')'. Run 'Get-Help Set-AzStorageContainerAcl -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_Storage_Audit_AuthN_Requests","Failed","Storage","apimdemo01_rg","fnapimdemo01dev","Medium","No","No","No","Yes","Storage Account must be configured to log and monitor authentication request data","First, run the command '$storageAccount = Get-AzStorageAccount -ResourceGroupName <RGName> -Name <Storage Name> -ErrorAction SilentlyContinue'. Then, run '$storageContext = $storageAccount.Context'. This is the value that you need to supply for -Context in the subsequent commands. Run command 'Set-AzStorageServiceLoggingProperty -ServiceType '<Blob/Queue/Table>' -LoggingOperations 'All' -Context $storageContext -RetentionDays '365' -PassThru'. Run 'Get-Help Set-AzStorageServiceLoggingProperty -full' for more help. Set-AzStorageServiceMetricsProperty -MetricsType 'Hour' -ServiceType '<Blob/Queue/Table/File>' -Context storageContext -MetricsLevel 'ServiceAndApi' -RetentionDays '365' -PassThru. Run 'Get-Help Set-AzStorageServiceMetricsProperty -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_Storage_DP_Encrypt_In_Transit","Passed","Storage","apimdemo01_rg","fnapimdemo01dev","High","Yes","No","No","Yes","HTTPS protocol must be used for accessing Storage Account resources","Run command 'Set-AzStorageAccount -ResourceGroupName <RGName> -Name <StorageAccountName> -EnableHttpsTrafficOnly $true'. Run 'Get-Help Set-AzStorageAccount -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_Storage_DP_Restrict_CORS_Access","Passed","Storage","apimdemo01_rg","fnapimdemo01dev","Medium","No","No","No","No","Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.","Go to Azure Portal --> your Storage service --> Settings --> CORS --> for each of the Storage services  i.e. Blob/File/Table/Queue --> Add --> Provide the specific domain names and other CORS details that should be allowed to make cross-origin calls. Note: No action is needed if you are not using CORS for your service.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_Storage_AuthZ_Restrict_Network_Access","Verify","Storage","apimdemo01_rg","fnapimdemo01dev","Medium","No","No","No","No","Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins","Go to Azure Portal --> your Storage service --> Settings --> Firewalls and virtual networks --> Selected Network. Provide the specific IP address and Virtual Network details that should be allowed to access storage account.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_Storage_BCDR_Enable_Soft_Delete","Verify","Storage","apimdemo01_rg","fnapimdemo01dev","Medium","No","No","No","No","Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots","Refer: https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete to enable soft delete feature on Storage.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_Storage_AuthZ_Grant_Min_RBAC_Access","Verify","Storage","apimdemo01_rg","fnapimdemo01dev","Medium","No","No","No","No","All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)","Remove any excessive privileges granted on the Search service. Run command: Remove-AzRoleAssignment -SignInName '<SignInName>' -Scope '<Scope>' RoleDefinitionName '<RoleDefinitionName>'. Run 'Get-Help Remove-AzRoleAssignment -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_Storage_AuthN_Use_AAD_Based_Access","Verify","Storage","apimdemo01_rg","fnapimdemo01dev","Medium","No","No","No","No","Use AAD-based access for storage account","Refer: https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview, https://docs.microsoft.com/en-us/azure/storage/common/storage-auth-aad-msi ","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_Storage_AuthZ_Use_IP_ACL","Manual","Storage","apimdemo01_rg","fnapimdemo01dev","Medium","No","No","No","No","Use IP-restrictions in SAS tokens to only permit access from intended IP addresses","Restrict storage SAS tokens to specific IP addresses/ranges where possible. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1. Note: In case the IP range is indeterminate (for instance, if the client is a PaaS endpoint), you may need to attest this control.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_Storage_AuthZ_Clients_Use_SAS","Manual","Storage","apimdemo01_rg","fnapimdemo01dev","High","No","No","No","No","End user/client apps should access Storage Account through SAS token only (and not via Storage Account Key)","Do not use Storage Account key directly in apps. Use a SAS token to limit the access based on scope, duration, IPs, etc. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_Storage_DP_Rotate_Keys","Manual","Storage","apimdemo01_rg","fnapimdemo01dev","Medium","No","No","No","No","Storage Account keys must be rotated periodically","Rotate Storage Account keys on a periodic basis. To generated a new key, run command 'New-AzStorageAccountKey -KeyName '<key1/key2>' -Name '<StorageAccountName>' -ResourceGroupName '<RGName>'. Deploy the new key or derived SAS tokens to various clients as appropriate. Run 'Get-Help New-AzStorageAccountKey -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_Storage_AuthZ_Allow_Limited_Access_to_Services","Manual","Storage","apimdemo01_rg","fnapimdemo01dev","High","No","No","No","No","Use Stored Access Policies with least privileges needed to access services in the Storage Account.","Create a SAS token with Stored Access Policy for service access using the minimal required privileges. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1#controlling-a-sas-with-a-stored-access-policy.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Storage/storageAccounts/fnapimdemo01dev","/apimdemo01_rg/Storage.LOG"
"Azure_AppService_AuthZ_Grant_Min_RBAC_Access","Verify","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)","Remove any excessive privileges granted on the App Service. Run command: Remove-AzRoleAssignment -SignInName '<SignInName>' -Scope '<Scope>' RoleDefinitionName '<RoleDefinitionName>'. Run 'Get-Help Remove-AzRoleAssignment -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Use_CNAME_With_SSL","Failed","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Custom domain with SSL binding must be configured for App Service","Go to Azure Portal --> your App Service --> Settings --> Custom Domains and follow the steps mentioned to configure a custom domain. Run command 'New-AzWebAppSSLBinding' to enable the SSL binding for your custom domain. Run 'Get-Help New-AzWebAppSSLBinding -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_AuthN_Use_AAD_for_Client_AuthN","Passed","AppService","apimdemo01_rg","core-infra-dev","High","Yes","No","No","No","App Service must authenticate users using Azure Active Directory backed credentials","Go to Azure Portal --> your App Service --> Settings --> Authentication/Authorization --> turn on 'App Service Authentication' --> Click on 'Azure Active Directory' under Authentication Providers to configure the AAD authentication. There will be a list of options to choose from under 'Action to take when request is not authenticated'. Please make sure that this value is not set to 'Allow Anonymous requests (no action)'. Note: If you are implementing this control via code, then you can attest to the same and mark this as passed. Note: In case of Functions apps, AAD authentication is required only for 'Http Trigger' functions.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_Config_Disable_Remote_Debugging","Passed","AppService","apimdemo01_rg","core-infra-dev","High","Yes","No","No","No","Remote debugging must be turned off for App Service","Go to Azure Portal --> your App Service --> Settings --> Configuration --> General Settings --> Remote Debugging --> Click on 'OFF'.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_Config_Disable_Web_Sockets","Passed","AppService","apimdemo01_rg","core-infra-dev","High","Yes","No","No","Yes","Web Sockets should be disabled for App Service","Run command 'Set-AzWebApp -Name '<WebAppName>' -ResourceGroupName '<RGName>' -WebSocketsEnabled $false'. Run 'Get-Help Set-AzWebApp -full' for more help. Refer: https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/HTML5_Security_Cheat_Sheet.md#websockets","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_Deploy_Use_Latest_Version","Passed","AppService","apimdemo01_rg","core-infra-dev","Low","No","No","No","Yes","The latest version of .NET framework version should be used for App Service","Run command 'Set-AzWebApp -Name '<WebAppName>' -ResourceGroupName '<RGName>' -NetFrameworkVersion 'v4.7''. Run 'Get-Help Set-AzWebApp -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_Audit_Enable_Logging_and_Monitoring","Failed","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","Yes","Auditing and Monitoring must be enabled for App Service","Run command 'Set-AzWebApp -Name '<WebAppName>' -ResourceGroupName '<RGName>' -DetailedErrorLoggingEnabled $true -HttpLoggingEnabled $true -RequestTracingEnabled $true'. Run 'Get-Help Set-AzWebApp -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Dont_Allow_HTTP_Access","Passed","AppService","apimdemo01_rg","core-infra-dev","High","Yes","No","No","Yes","App Service must only be accessible over HTTPS","Run command 'Set-AzWebApp -Name '<WebAppName>' -ResourceGroupName '<RGName>' -HttpsOnly $true. Run 'Get-Help Set-AzWebApp -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Website_Load_Certificates_Not_All","Passed","AppService","apimdemo01_rg","core-infra-dev","High","No","No","No","No","WEBSITE_LOAD_CERTIFICATES parameter must not be set to '*' (i.e. all) for App Service","Go to Azure Portal --> your App Service --> Settings --> Configuration --> Application Settings --> Check for 'WEBSITE_LOAD_CERTIFICATES' key and make sure that value is not set to '*'. Instead choose the specific certificate that is required by the App Service. Refer https://msftplayground.com/2016/11/using-certificates-azure-app-services/ for more details.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_Authz_Use_Function_Authorization_level_Fn","Passed","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Authorization level for HTTP Trigger function in a function app should be set to 'Function'","Go to Azure Portal --> your Functions App --> your HTTP Trigger Function --> Integrate --> Change Authorization level.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_Configure_EditMode_ReadOnly_Fn","Verify","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Functions app edit mode should be set to Read Only","Go to Azure Portal --> your Functions App --> Functions app settings --> Function app edit mode --> Click on 'Read Only'.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Restrict_CORS_Access","Verify","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Ensure that CORS access is granted to a limited set of trusted origins.","Go to Azure Portal --> your App Service --> API --> CORS --> Provide the specific domain names that should be allowed to make cross-origin calls. Note: No action is needed if you are not using CORS for your app.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_AuthN_Use_Managed_Service_Identity","Passed","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Use Managed Service Identity (MSI) for accessing other AAD-protected resources from the app service.","Go to Azure Portal --> your App Service --> Settings --> Identity --> System assigned --> ON","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Dont_Allow_HTTP_Access_Fn","Passed","AppService","apimdemo01_rg","core-infra-dev","High","Yes","No","No","No","Function App must only be accessible over HTTPS","Run command 'Set-AzResource -ResourceName '<WebAppName>' -ResourceGroupName '<RGName>' -ResourceType 'Microsoft.Web/sites' -Properties @{httpsOnly='true'} -Force '. Run 'Get-Help Set-AzResource -full' for more help. Note:'HttpsOnly' is required only for 'Http Trigger' functions.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Use_Secure_TLS_Version","Passed","AppService","apimdemo01_rg","core-infra-dev","High","Yes","No","No","Yes","Use approved version of TLS for the App Service","Go to Azure Portal --> your App Service --> Settings --> TLS/SSL --> Minimum TLS version --> set to org approved version (see detailed logs).","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Verify_Installed_Extensions","Passed","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Extensions installed on a App Service should be carefully reviewed","Go to Azure Portal --> your App Service --> Development Tools --> Extensions --> Verify installed extensions.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_AuthZ_Configure_IP_Restrictions","Verify","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Setup IP-based access restrictions for App Service if feasible","Consider using IP-based access restrictions for App Service if feasible. Steps: Go to Azure Portal --> your App Service --> Networking --> Access Restrictions --> Configure Access Restrictions --> Add/Verify access restriction rule for app and scm site. For more information, refer: https://docs.microsoft.com/en-us/azure/app-service/app-service-ip-restrictions","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Review_CORS_Request_Credential","Passed","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Review use of credentials in CORS request for App Service","Go to Azure Portal --> your App Service --> API --> CORS --> Request Credentials --> Review if you need to enable 'Access-Control-Allow-Credentials'. Note: No action is needed if you are not using CORS for your app.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_Deploy_Dont_Use_Publish_Profiles","Manual","AppService","apimdemo01_rg","core-infra-dev","High","No","No","No","No","Publish profile credentials must not be used for App Service deployment","No predefined role should be present in the App Service and all the custom roles must have all 'publishxml' operations added as the Non Actions, e.g. 'microsoft.web/sites/publishxml/read'. Refer https://docs.microsoft.com/en-us/azure/app-service/faq-deployment#i-am-just-getting-started-with-app-service-web-apps-how-do-i-publish-my-code for exploring ways to securely deploy app service.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Store_Secrets_in_Key_Vault","Manual","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","All App Service secrets should be stored in Key Vault","Refer https://azure.microsoft.com/en-in/documentation/articles/key-vault-get-started/ for configuring Key Vault and storing secrets.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_Deploy_Use_Notification_Hub","Manual","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","App Service should use Notification Hub for push notification (instead of directly using Push Notification Service)","Refer https://docs.microsoft.com/en-us/azure/notification-hubs/ for details on configuring Notification Hub for push notifications.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_Deploy_Use_ARM_Template","Manual","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Deployment of App Service should be done using ARM template","Use an ARM Template to ensure fully repeatable and secured configuration of a deployment. Refer https://azure.microsoft.com/en-gb/resources/templates/ to get sample quickstart templates.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Configure_Rotate_Keys_Fn","Manual","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Keys should be renewed after a regular interval","Refer https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-http-webhook#authorization-keys for details on Host keys in Functions app.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Dont_Share_HostKeys_Fn","Manual","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Host key access should not be shared with individual clients","Refer https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-http-webhook#authorization-keys for details on Host keys in Functions app.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_AppService_DP_Use_Individual_FunctionKeys_Fn","Manual","AppService","apimdemo01_rg","core-infra-dev","Medium","No","No","No","No","Different functions keys must be generated and shared with individual clients.","Go to Azure Portal --> your Functions App --> your Function --> Manage --> Add New Function Key.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/apimdemo01_rg/providers/Microsoft.Web/sites/core-infra-dev","/apimdemo01_rg/AppService.LOG"
"Azure_Storage_AuthN_Dont_Allow_Anonymous","Passed","Storage","cost_mgmt_rg","almcostmgmt","High","Yes","No","No","Yes","The Access Type for containers must not be set to 'Anonymous'","Run command 'Set-AzStorageContainerAcl -Name '<ContainerName>' -Permission 'Off' -Context (New-AzStorageContext -StorageAccountName '<StorageAccountName>' -StorageAccountKey '<StorageAccountKey>')'. Run 'Get-Help Set-AzStorageContainerAcl -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_Audit_AuthN_Requests","Failed","Storage","cost_mgmt_rg","almcostmgmt","Medium","No","No","No","Yes","Storage Account must be configured to log and monitor authentication request data","First, run the command '$storageAccount = Get-AzStorageAccount -ResourceGroupName <RGName> -Name <Storage Name> -ErrorAction SilentlyContinue'. Then, run '$storageContext = $storageAccount.Context'. This is the value that you need to supply for -Context in the subsequent commands. Run command 'Set-AzStorageServiceLoggingProperty -ServiceType '<Blob/Queue/Table>' -LoggingOperations 'All' -Context $storageContext -RetentionDays '365' -PassThru'. Run 'Get-Help Set-AzStorageServiceLoggingProperty -full' for more help. Set-AzStorageServiceMetricsProperty -MetricsType 'Hour' -ServiceType '<Blob/Queue/Table/File>' -Context storageContext -MetricsLevel 'ServiceAndApi' -RetentionDays '365' -PassThru. Run 'Get-Help Set-AzStorageServiceMetricsProperty -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_DP_Encrypt_In_Transit","Failed","Storage","cost_mgmt_rg","almcostmgmt","High","Yes","No","No","Yes","HTTPS protocol must be used for accessing Storage Account resources","Run command 'Set-AzStorageAccount -ResourceGroupName <RGName> -Name <StorageAccountName> -EnableHttpsTrafficOnly $true'. Run 'Get-Help Set-AzStorageAccount -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_DP_Restrict_CORS_Access","Passed","Storage","cost_mgmt_rg","almcostmgmt","Medium","No","No","No","No","Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.","Go to Azure Portal --> your Storage service --> Settings --> CORS --> for each of the Storage services  i.e. Blob/File/Table/Queue --> Add --> Provide the specific domain names and other CORS details that should be allowed to make cross-origin calls. Note: No action is needed if you are not using CORS for your service.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthZ_Restrict_Network_Access","Verify","Storage","cost_mgmt_rg","almcostmgmt","Medium","No","No","No","No","Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins","Go to Azure Portal --> your Storage service --> Settings --> Firewalls and virtual networks --> Selected Network. Provide the specific IP address and Virtual Network details that should be allowed to access storage account.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_BCDR_Enable_Soft_Delete","Verify","Storage","cost_mgmt_rg","almcostmgmt","Medium","No","No","No","No","Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots","Refer: https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete to enable soft delete feature on Storage.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthZ_Grant_Min_RBAC_Access","Verify","Storage","cost_mgmt_rg","almcostmgmt","Medium","No","No","No","No","All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)","Remove any excessive privileges granted on the Search service. Run command: Remove-AzRoleAssignment -SignInName '<SignInName>' -Scope '<Scope>' RoleDefinitionName '<RoleDefinitionName>'. Run 'Get-Help Remove-AzRoleAssignment -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthN_Use_AAD_Based_Access","Verify","Storage","cost_mgmt_rg","almcostmgmt","Medium","No","No","No","No","Use AAD-based access for storage account","Refer: https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview, https://docs.microsoft.com/en-us/azure/storage/common/storage-auth-aad-msi ","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthZ_Use_IP_ACL","Manual","Storage","cost_mgmt_rg","almcostmgmt","Medium","No","No","No","No","Use IP-restrictions in SAS tokens to only permit access from intended IP addresses","Restrict storage SAS tokens to specific IP addresses/ranges where possible. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1. Note: In case the IP range is indeterminate (for instance, if the client is a PaaS endpoint), you may need to attest this control.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthZ_Clients_Use_SAS","Manual","Storage","cost_mgmt_rg","almcostmgmt","High","No","No","No","No","End user/client apps should access Storage Account through SAS token only (and not via Storage Account Key)","Do not use Storage Account key directly in apps. Use a SAS token to limit the access based on scope, duration, IPs, etc. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_DP_Rotate_Keys","Manual","Storage","cost_mgmt_rg","almcostmgmt","Medium","No","No","No","No","Storage Account keys must be rotated periodically","Rotate Storage Account keys on a periodic basis. To generated a new key, run command 'New-AzStorageAccountKey -KeyName '<key1/key2>' -Name '<StorageAccountName>' -ResourceGroupName '<RGName>'. Deploy the new key or derived SAS tokens to various clients as appropriate. Run 'Get-Help New-AzStorageAccountKey -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthZ_Allow_Limited_Access_to_Services","Manual","Storage","cost_mgmt_rg","almcostmgmt","High","No","No","No","No","Use Stored Access Policies with least privileges needed to access services in the Storage Account.","Create a SAS token with Stored Access Policy for service access using the minimal required privileges. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1#controlling-a-sas-with-a-stored-access-policy.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthN_Dont_Allow_Anonymous","Passed","Storage","cost_mgmt_rg","almcostmgmt2","High","Yes","No","No","Yes","The Access Type for containers must not be set to 'Anonymous'","Run command 'Set-AzStorageContainerAcl -Name '<ContainerName>' -Permission 'Off' -Context (New-AzStorageContext -StorageAccountName '<StorageAccountName>' -StorageAccountKey '<StorageAccountKey>')'. Run 'Get-Help Set-AzStorageContainerAcl -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_Audit_AuthN_Requests","Failed","Storage","cost_mgmt_rg","almcostmgmt2","Medium","No","No","No","Yes","Storage Account must be configured to log and monitor authentication request data","First, run the command '$storageAccount = Get-AzStorageAccount -ResourceGroupName <RGName> -Name <Storage Name> -ErrorAction SilentlyContinue'. Then, run '$storageContext = $storageAccount.Context'. This is the value that you need to supply for -Context in the subsequent commands. Run command 'Set-AzStorageServiceLoggingProperty -ServiceType '<Blob/Queue/Table>' -LoggingOperations 'All' -Context $storageContext -RetentionDays '365' -PassThru'. Run 'Get-Help Set-AzStorageServiceLoggingProperty -full' for more help. Set-AzStorageServiceMetricsProperty -MetricsType 'Hour' -ServiceType '<Blob/Queue/Table/File>' -Context storageContext -MetricsLevel 'ServiceAndApi' -RetentionDays '365' -PassThru. Run 'Get-Help Set-AzStorageServiceMetricsProperty -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_DP_Encrypt_In_Transit","Failed","Storage","cost_mgmt_rg","almcostmgmt2","High","Yes","No","No","Yes","HTTPS protocol must be used for accessing Storage Account resources","Run command 'Set-AzStorageAccount -ResourceGroupName <RGName> -Name <StorageAccountName> -EnableHttpsTrafficOnly $true'. Run 'Get-Help Set-AzStorageAccount -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_DP_Restrict_CORS_Access","Passed","Storage","cost_mgmt_rg","almcostmgmt2","Medium","No","No","No","No","Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.","Go to Azure Portal --> your Storage service --> Settings --> CORS --> for each of the Storage services  i.e. Blob/File/Table/Queue --> Add --> Provide the specific domain names and other CORS details that should be allowed to make cross-origin calls. Note: No action is needed if you are not using CORS for your service.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthZ_Restrict_Network_Access","Verify","Storage","cost_mgmt_rg","almcostmgmt2","Medium","No","No","No","No","Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins","Go to Azure Portal --> your Storage service --> Settings --> Firewalls and virtual networks --> Selected Network. Provide the specific IP address and Virtual Network details that should be allowed to access storage account.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_BCDR_Enable_Soft_Delete","Verify","Storage","cost_mgmt_rg","almcostmgmt2","Medium","No","No","No","No","Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots","Refer: https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete to enable soft delete feature on Storage.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthZ_Grant_Min_RBAC_Access","Verify","Storage","cost_mgmt_rg","almcostmgmt2","Medium","No","No","No","No","All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)","Remove any excessive privileges granted on the Search service. Run command: Remove-AzRoleAssignment -SignInName '<SignInName>' -Scope '<Scope>' RoleDefinitionName '<RoleDefinitionName>'. Run 'Get-Help Remove-AzRoleAssignment -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthN_Use_AAD_Based_Access","Verify","Storage","cost_mgmt_rg","almcostmgmt2","Medium","No","No","No","No","Use AAD-based access for storage account","Refer: https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview, https://docs.microsoft.com/en-us/azure/storage/common/storage-auth-aad-msi ","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthZ_Use_IP_ACL","Manual","Storage","cost_mgmt_rg","almcostmgmt2","Medium","No","No","No","No","Use IP-restrictions in SAS tokens to only permit access from intended IP addresses","Restrict storage SAS tokens to specific IP addresses/ranges where possible. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1. Note: In case the IP range is indeterminate (for instance, if the client is a PaaS endpoint), you may need to attest this control.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthZ_Clients_Use_SAS","Manual","Storage","cost_mgmt_rg","almcostmgmt2","High","No","No","No","No","End user/client apps should access Storage Account through SAS token only (and not via Storage Account Key)","Do not use Storage Account key directly in apps. Use a SAS token to limit the access based on scope, duration, IPs, etc. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_DP_Rotate_Keys","Manual","Storage","cost_mgmt_rg","almcostmgmt2","Medium","No","No","No","No","Storage Account keys must be rotated periodically","Rotate Storage Account keys on a periodic basis. To generated a new key, run command 'New-AzStorageAccountKey -KeyName '<key1/key2>' -Name '<StorageAccountName>' -ResourceGroupName '<RGName>'. Deploy the new key or derived SAS tokens to various clients as appropriate. Run 'Get-Help New-AzStorageAccountKey -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Storage_AuthZ_Allow_Limited_Access_to_Services","Manual","Storage","cost_mgmt_rg","almcostmgmt2","High","No","No","No","No","Use Stored Access Policies with least privileges needed to access services in the Storage Account.","Create a SAS token with Stored Access Policy for service access using the minimal required privileges. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1#controlling-a-sas-with-a-stored-access-policy.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/cost_mgmt_rg/providers/Microsoft.Storage/storageAccounts/almcostmgmt2","/cost_mgmt_rg/Storage.LOG"
"Azure_Databricks_DP_No_PlainText_Secrets_In_Notebooks","Manual","Databricks","rg_databricks_001","workspace-001","High","No","No","No","No","Secrets and keys must not be in plain text in notebooks and jobs","Use a key vault backed Databricks secret scopes to store any secrets and keys and read them from the respective secret scopes in notebooks and jobs. Refer: https://docs.azuredatabricks.net/user-guide/secrets/index.html","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_DP_Use_KeyVault_Backed_Secret_Scope","Manual","Databricks","rg_databricks_001","workspace-001","Medium","No","No","No","No","Use Azure Key Vault backed secret scope to hold secrets","To use Azure Key Vault backed secret scopes, refer: https://docs.azuredatabricks.net/user-guide/secrets/secret-scopes.html#create-an-azure-key-vault-backed-secret-scope","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_DP_Independent_KeyVault_Per_Scope","Manual","Databricks","rg_databricks_001","workspace-001","Medium","No","No","No","No","Each secret scope should use an independent key vault","Analyze the separation of access needed in your solution and use different scopes backed by independent key vaults as necessary.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_DP_Minimal_Token_Validity","Manual","Databricks","rg_databricks_001","workspace-001","High","No","No","No","No","Personal access tokens (PAT) must have a shortest possible validity period","While creating a PAT, provide the minimum practical expiration period. You can see all tokens genearted by you and their expiration periods by navigating to Databricks Workspace --> Profile --> User Settings --> Access Tokens","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_AuthZ_Grant_Min_RBAC_Access","Verify","Databricks","rg_databricks_001","workspace-001","Medium","No","No","No","No","All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)","Remove any excessive privileges granted on the Databricks. Run command: Remove-AzRoleAssignment -SignInName '<SignInName>' -Scope '<Scope>' RoleDefinitionName '<RoleDefinitionName>'. Run 'Get-Help Remove-AzRoleAssignment -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_AuthZ_Limit_Admin_Count","Manual","Databricks","rg_databricks_001","workspace-001","Medium","No","No","No","No","Minimize the number of workspace admins","Minimize the number of workspace admins. Navigate to Databricks workspace --> Account --> Admin Console --> Users --> Revoke admin access for users(who no longer requires admin access)","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_AuthZ_Enable_Workspace_Access_Control","Verify","Databricks","rg_databricks_001","workspace-001","Medium","No","No","No","No","Workspace access control should be enabled","To enable and configure workspace access control, refer: https://docs.azuredatabricks.net/administration-guide/admin-settings/workspace-acl.html","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_AuthZ_Enable_Cluster_Access_Control","Verify","Databricks","rg_databricks_001","workspace-001","Medium","No","No","No","No","Cluster access control should be enabled","To enable and configure cluster access control, refer: https://docs.azuredatabricks.net/administration-guide/admin-settings/cluster-acl.html","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_AuthZ_Enable_Job_Access_Control","Verify","Databricks","rg_databricks_001","workspace-001","Medium","No","No","No","No","Job access control should be enabled","To enable and configure job access control, refer: https://docs.azuredatabricks.net/administration-guide/admin-settings/jobs-acl.html","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_AuthZ_Prohibit_Guest_Account_Admin_Access","Manual","Databricks","rg_databricks_001","workspace-001","High","No","No","No","No","Guest accounts within the AAD tenant should not be granted admin access","Avoid granting access to guest accounts from the AAD tentant. Remove any such accounts that may have been granted access in the past. Navigate to Databricks workspace --> Account --> Admin Console --> Users --> Revoke admin access of guest users(who no longer requires admin access)","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_NetSec_Justify_VNet_Peering","Manual","Databricks","rg_databricks_001","workspace-001","High","Yes","No","No","No","Use of any virtual network peerings should be justified","You can remove any virtual network peering by navigating to Azure portal --> Databricks --> Virtual Network Peerings --> select vNET peering --> Delete (unless their presence has been approved by network security team).","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_AuthZ_Cluster_Grant_Min_RBAC_Access","Manual","Databricks","rg_databricks_001","workspace-001","Medium","No","No","No","No","All users must be granted minimum required permissions on clusters","Remove any excessive privileges granted to any user on clusters. Navigate to workspace --> clusters --> select cluster --> Edit --> Permissions, for details refer: https://docs.azuredatabricks.net/administration-guide/admin-settings/cluster-acl.html","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_Databricks_DP_Review_Mounted_DataSources","Manual","Databricks","rg_databricks_001","workspace-001","Medium","No","No","No","No","Do not mount any data sources that may not be required for all users in the workspace.","Create a mount point only if all users in workspace need to have access to all data in the mounted data source. Use tables with ACLs if you want to impose segregation of access on imported data.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_databricks_001/providers/Microsoft.Databricks/workspaces/workspace-001","/rg_databricks_001/Databricks.LOG"
"Azure_VirtualMachine_Deploy_Latest_OS_Version","Verify","VirtualMachine","rg_iaas_001","vm001001","Medium","No","No","No","No","Virtual Machine should have latest OS version installed","Run command 'Update-AzVM -ResourceGroupName {resourceGroupName} -VM (Get-AzVM -ResourceGroupName {resourceGroupName} -Name {vmName})' . Run 'Get-Help Update-AzVM -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_SI_Enable_Antimalware","Manual","VirtualMachine","rg_iaas_001","vm001001","High","No","Yes","No","No","Antimalware must be enabled with real time protection on Virtual Machine","To install antimalware, Go to Azure Portal --> VM Properties --> Extensions --> Add 'Microsoft Antimalware' --> Enable Real-Time Protection and Scheduled Scan --> Click Ok. If antimalware is already present on VM, validate and resolve endpoint protection recommendations in ASC. Refer: https://docs.microsoft.com/en-us/azure/security-center/security-center-install-endpoint-protection, https://docs.microsoft.com/en-us/azure/security/azure-security-antimalware","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_Config_Enable_NSG","Failed","VirtualMachine","rg_iaas_001","vm001001","Medium","No","No","No","No","NSG must be configured for Virtual Machine","Refer: https://docs.microsoft.com/en-us/azure/virtual-machines/windows/endpoints-in-resource-manager, https://docs.microsoft.com/en-us/azure/virtual-network/virtual-networks-create-nsg-arm-ps","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_NetSec_Justify_PublicIPs","Passed","VirtualMachine","rg_iaas_001","vm001001","High","Yes","No","No","No","Public IPs on a Virtual Machine should be carefully reviewed","Go to Azure Portal --> VM Settings --> Networking --> Network Interfaces --> <Select NIC> --> IP Configurations --> <Select IP Configs with Public IP> --> Click 'Disabled' --> Save. Refer: https://docs.microsoft.com/en-us/azure/virtual-network/virtual-network-public-ip-address ","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_SI_ASC_OS_Vulnerabilities","Verify","VirtualMachine","rg_iaas_001","vm001001","High","No","No","No","No","Virtual Machine must be in a healthy state in Azure Security Center","Refer: https://docs.microsoft.com/en-us/azure/security-center/security-center-remediate-os-vulnerabilities","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_SI_Missing_OS_Patches","Verify","VirtualMachine","rg_iaas_001","vm001001","High","No","No","No","No","Virtual Machine must have all the required OS patches installed.","Refer: https://docs.microsoft.com/en-us/azure/security-center/security-center-apply-system-updates . It takes 24 hours to reflect the latest status at ASC.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_SI_ASC_Recommendations","Passed","VirtualMachine","rg_iaas_001","vm001001","High","No","No","No","No","Virtual Machine must implement all the flagged ASC recommendations.","First, examine the detailed AzSK log file for this VM to find out the specific recommendations this control is currently failing for. Review the ASC documentation for those recommendations and implement the suggested fixes. (Note: Not all ASC recommendations are flagged by AzSK. So the first step is critical.). Refer: https://docs.microsoft.com/en-us/azure/security-center/security-center-virtual-machine-recommendations","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_Audit_Enable_Diagnostics","Failed","VirtualMachine","rg_iaas_001","vm001001","Medium","No","No","No","No","Diagnostics (IaaSDiagnostics extension on Windows; LinuxDiagnostic extension on Linux) must be enabled on Virtual Machine","Go to Azure Portal --> VM Properties --> Diagnostics settings --> Enable guest-level-monitoring. Refer: https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/azure-diagnostics","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_NetSec_Dont_Open_Management_Ports","Failed","VirtualMachine","rg_iaas_001","vm001001","Critical","No","No","No","No","Do not leave management ports open on Virtual Machines","Go to Azure Portal --> VM Settings --> Networking --> Inbound security rules --> Select security rule which allows management ports (e.g. RDP-3389, WINRM-5985, SSH-22) --> Click 'Deny' under Action --> Click Save.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_SI_Enable_Vuln_Solution","Failed","VirtualMachine","rg_iaas_001","vm001001","Medium","No","Yes","No","No","Vulnerability assessment solution should be installed on VM","To install vulnerability assessment solution, please refer: https://docs.microsoft.com/en-us/azure/security-center/security-center-vulnerability-assessment-recommendations","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_SI_Deploy_GuestConfig_Extension","Failed","VirtualMachine","rg_iaas_001","vm001001","Medium","No","Yes","No","No","Guest Configuration extension must be deployed to the VM using Azure Policy assignment","This control checks that the VM meets the following criteria: [a] Guest Configuration Extension is installed and provisioned successfully, [b] 'SystemAssigned' managed identity (MSI) is enabled for the VM. Both, the required Guest Configuration extension and a system-assigned MSI, will be automatically deployed and configured when the machine is in scope for an Azure Policy assignment that includes definitions in the Guest Configuration category.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_SI_GuestConfig_Policy_Health","Passed","VirtualMachine","rg_iaas_001","vm001001","Medium","No","Yes","No","No","Guest config extension should report compliant status for all in-guest policies.","Run Get-AzVMGuestPolicyStatus -ResourceGroupName <VM Resource group name> -VMName <VM Name> to get further details like Compliance reason, last check time etc. and ensure that the issues are resolved.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_VirtualMachine_SI_Deploy_Required_Extensions","Failed","VirtualMachine","rg_iaas_001","vm001001","Medium","No","Yes","No","No","All VM extensions required as per your Org policy must be deployed to the VM","Please look at the detailed AzSK scan logs to determine missing or unhealthy extensions and fix them using command: Set-AzVMExtension -ResourceGroupName '<VM Resource Group Name}>'  -VMName  '<VM Resource Name>'  -Name '<Extension Name>' -Publisher '<Publisher>' -Type '<ExtensionType>'","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Compute/virtualMachines/vm001001","/rg_iaas_001/VirtualMachine.LOG"
"Azure_Storage_AuthN_Dont_Allow_Anonymous","Passed","Storage","rg_iaas_001","diag1c3407e369a8c27e","High","Yes","No","No","Yes","The Access Type for containers must not be set to 'Anonymous'","Run command 'Set-AzStorageContainerAcl -Name '<ContainerName>' -Permission 'Off' -Context (New-AzStorageContext -StorageAccountName '<StorageAccountName>' -StorageAccountKey '<StorageAccountKey>')'. Run 'Get-Help Set-AzStorageContainerAcl -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_Storage_Audit_AuthN_Requests","Failed","Storage","rg_iaas_001","diag1c3407e369a8c27e","Medium","No","No","No","Yes","Storage Account must be configured to log and monitor authentication request data","First, run the command '$storageAccount = Get-AzStorageAccount -ResourceGroupName <RGName> -Name <Storage Name> -ErrorAction SilentlyContinue'. Then, run '$storageContext = $storageAccount.Context'. This is the value that you need to supply for -Context in the subsequent commands. Run command 'Set-AzStorageServiceLoggingProperty -ServiceType '<Blob/Queue/Table>' -LoggingOperations 'All' -Context $storageContext -RetentionDays '365' -PassThru'. Run 'Get-Help Set-AzStorageServiceLoggingProperty -full' for more help. Set-AzStorageServiceMetricsProperty -MetricsType 'Hour' -ServiceType '<Blob/Queue/Table/File>' -Context storageContext -MetricsLevel 'ServiceAndApi' -RetentionDays '365' -PassThru. Run 'Get-Help Set-AzStorageServiceMetricsProperty -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_Storage_DP_Encrypt_In_Transit","Failed","Storage","rg_iaas_001","diag1c3407e369a8c27e","High","Yes","No","No","Yes","HTTPS protocol must be used for accessing Storage Account resources","Run command 'Set-AzStorageAccount -ResourceGroupName <RGName> -Name <StorageAccountName> -EnableHttpsTrafficOnly $true'. Run 'Get-Help Set-AzStorageAccount -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_Storage_DP_Restrict_CORS_Access","Passed","Storage","rg_iaas_001","diag1c3407e369a8c27e","Medium","No","No","No","No","Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.","Go to Azure Portal --> your Storage service --> Settings --> CORS --> for each of the Storage services  i.e. Blob/File/Table/Queue --> Add --> Provide the specific domain names and other CORS details that should be allowed to make cross-origin calls. Note: No action is needed if you are not using CORS for your service.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_Storage_AuthZ_Restrict_Network_Access","Verify","Storage","rg_iaas_001","diag1c3407e369a8c27e","Medium","No","No","No","No","Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins","Go to Azure Portal --> your Storage service --> Settings --> Firewalls and virtual networks --> Selected Network. Provide the specific IP address and Virtual Network details that should be allowed to access storage account.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_Storage_BCDR_Enable_Soft_Delete","Verify","Storage","rg_iaas_001","diag1c3407e369a8c27e","Medium","No","No","No","No","Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots","Refer: https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete to enable soft delete feature on Storage.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_Storage_AuthZ_Grant_Min_RBAC_Access","Verify","Storage","rg_iaas_001","diag1c3407e369a8c27e","Medium","No","No","No","No","All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)","Remove any excessive privileges granted on the Search service. Run command: Remove-AzRoleAssignment -SignInName '<SignInName>' -Scope '<Scope>' RoleDefinitionName '<RoleDefinitionName>'. Run 'Get-Help Remove-AzRoleAssignment -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_Storage_AuthN_Use_AAD_Based_Access","Verify","Storage","rg_iaas_001","diag1c3407e369a8c27e","Medium","No","No","No","No","Use AAD-based access for storage account","Refer: https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview, https://docs.microsoft.com/en-us/azure/storage/common/storage-auth-aad-msi ","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_Storage_AuthZ_Use_IP_ACL","Manual","Storage","rg_iaas_001","diag1c3407e369a8c27e","Medium","No","No","No","No","Use IP-restrictions in SAS tokens to only permit access from intended IP addresses","Restrict storage SAS tokens to specific IP addresses/ranges where possible. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1. Note: In case the IP range is indeterminate (for instance, if the client is a PaaS endpoint), you may need to attest this control.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_Storage_AuthZ_Clients_Use_SAS","Manual","Storage","rg_iaas_001","diag1c3407e369a8c27e","High","No","No","No","No","End user/client apps should access Storage Account through SAS token only (and not via Storage Account Key)","Do not use Storage Account key directly in apps. Use a SAS token to limit the access based on scope, duration, IPs, etc. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_Storage_DP_Rotate_Keys","Manual","Storage","rg_iaas_001","diag1c3407e369a8c27e","Medium","No","No","No","No","Storage Account keys must be rotated periodically","Rotate Storage Account keys on a periodic basis. To generated a new key, run command 'New-AzStorageAccountKey -KeyName '<key1/key2>' -Name '<StorageAccountName>' -ResourceGroupName '<RGName>'. Deploy the new key or derived SAS tokens to various clients as appropriate. Run 'Get-Help New-AzStorageAccountKey -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_Storage_AuthZ_Allow_Limited_Access_to_Services","Manual","Storage","rg_iaas_001","diag1c3407e369a8c27e","High","No","No","No","No","Use Stored Access Policies with least privileges needed to access services in the Storage Account.","Create a SAS token with Stored Access Policy for service access using the minimal required privileges. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1#controlling-a-sas-with-a-stored-access-policy.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_iaas_001/providers/Microsoft.Storage/storageAccounts/diag1c3407e369a8c27e","/rg_iaas_001/Storage.LOG"
"Azure_KeyVault_AuthN_Use_Cert_Auth_for_Apps","Passed","KeyVault","rg_sample_001","kv001demo001","High","No","No","No","No","Azure Active Directory applications, which have access to Key Vault, must use certificate to authenticate to Key Vault","Remove any password credentials from Azure AD Applications and use certificate credentials instead. Run command Remove-AzureADApplicationPasswordCredential -InformationAction '{ActionPreference}' -InformationVariable '{InformationVariable}' -KeyId '{KeyId}' -ObjectId '{ObjectId}'. Refer: https://docs.microsoft.com/en-us/powershell/module/azuread/remove-azureadapplicationpasswordcredential?view=azureadps-2.0, https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-certificate-credentials#register-your-certificate-with-azure-ad","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_AuthN_Dont_Share_KeyVault_Unless_Trust","Passed","KeyVault","rg_sample_001","kv001demo001","High","Yes","No","No","No","Applications must not share a Key Vault unless they trust each other and they need access to the same secrets at runtime","Ensure that there is a clear need for apps to share secrets if they are sharing a Key Vault. Else setup independent Key Vaults for each application.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_AuthZ_Grant_Min_RBAC_Access","Verify","KeyVault","rg_sample_001","kv001demo001","High","No","No","No","No","All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)","Remove any excessive privileges granted on the Key Vault. Run command Remove-AzRoleAssignment -SignInName '{signInName}' -Scope '{scope}' -RoleDefinitionName '{role definition name}'. Run 'Get-Help Remove-AzRoleAssignment -full' for more help. Assign 'Key Vault Contributor' RBAC role to developers who need to manage Key Vault configurations. Refer: https://docs.microsoft.com/en-us/azure/key-vault/key-vault-secure-your-key-vault, https://docs.microsoft.com/en-us/azure/active-directory/role-based-access-control-manage-access-powershell","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_AuthZ_Grant_Min_Access_policies","Verify","KeyVault","rg_sample_001","kv001demo001","High","No","No","No","No","All Key Vault access policies must be defined with minimum required permissions to keys and secrets","Use command Set-AzKeyVaultAccessPolicy -VaultName '{VaultName}' -ResourceGroupName '{ResourceGroupName}' -PermissionsToKeys '{PermissionsToKeys}' -PermissionsToSecrets '{PermissionsToSecrets}' -PermissionsToCertificates '{PermissionsToCertificates}' -ObjectId '{ObjectId}'. Refer: https://docs.microsoft.com/en-us/powershell/module/az.keyvault/Set-AzKeyVaultAccessPolicy","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_AuthZ_Configure_Advanced_Access_Policies","Passed","KeyVault","rg_sample_001","kv001demo001","Medium","No","No","No","No","Advanced access policies must be configured on a need basis","Remove any advanced policies that are not required using the command: Remove-AzKeyVaultAccessPolicy -VaultName '{VaultName}' -ResourceGroupName '{ResourceGroupName}' -EnabledForDeployment -EnabledForTemplateDeployment -EnabledForDiskEncryption. Refer: https://docs.microsoft.com/en-us/powershell/module/az.keyvault/Remove-AzKeyVaultAccessPolicy","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_DP_Keys_Protect_By_HSM","Manual","KeyVault","rg_sample_001","kv001demo001","Medium","No","No","No","No","All Keys in Key Vault must be protected by HSM [Key Type = HSM Protected Key]","Remove the non-HSM keys and recreate the removed ones within a destination Key Vault of type HSM. Run command Remove-AzKeyVaultKey -VaultName '{KeyVaultName}' -Name '{KeyName}' to remove non-HSM key. Use command Add-AzKeyVaultKey -VaultName '{VaultName}' -Name '{KeyName}' -Expires '{ExpiryDate}' -Destination 'HSM' -KeyOps '{KeyOps}'. Refer: https://docs.microsoft.com/en-us/powershell/module/az.keyvault/remove-azkeyvaultkey, https://docs.microsoft.com/en-us/powershell/module/az.keyvault/add-azkeyvaultkey","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_DP_Keys_Secrets_Check_Expiry_Date","Manual","KeyVault","rg_sample_001","kv001demo001","Medium","No","No","No","No","All Keys and Secrets in Key Vault must have expiration dates","(The status for this control has been marked as 'Manual' because elevated (Co-Admin/Owner/Contributor, as applicable) permission is required to check security configuration for this resource. You can re-run the control with the appropriate privilege.) To add an expiry date to keys, run command: Update-AzKeyVaultKey -VaultName '{KeyVaultName}' -Name '{KeyName}' -Expires '{ExpiryDate}'. Expiry date should not be more than 365 days for keys. To add an expiry date to secrets, run command: Update-AzKeyVaultSecret -VaultName '{KeyVaultName}' -Name '{SecretName}' -Expires '{ExpiryDate}', Expiry date should not be more than 180 days for secrets.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_Audit_Enable_Diagnostics_Log","Failed","KeyVault","rg_sample_001","kv001demo001","Medium","No","No","No","No","Diagnostics logs must be enabled with a retention period of at least 365 days.","You can change the diagnostic settings from the Azure Portal by following the steps given here: https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-archive-diagnostic-logs#archive-diagnostic-logs-using-the-portal","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_AuthN_Key_Min_Operation","Manual","KeyVault","rg_sample_001","kv001demo001","High","No","No","No","No","Restrict the cryptographic operations permitted using keys to the ones actually required","Run command Update-AzKeyVaultKey -VaultName '{KeyVaultName}' -Name '{KeyName}' -KeyOps '{KeyOps}'. Refer: https://docs.microsoft.com/en-us/powershell/module/az.keyvault/update-azkeyvaultkey","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_SI_Enable_SoftDelete","Failed","KeyVault","rg_sample_001","kv001demo001","Medium","No","No","No","No","Soft delete must be enabled to allow recovery of deleted Key Vault and any objects (keys, secrets, etc.) contained in it.","Refer: https://docs.microsoft.com/en-us/azure/key-vault/key-vault-soft-delete-powershell to enable soft delete feature on Key Vault.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_Avoid_Excessive_Versions_Keys_Secrets","Manual","KeyVault","rg_sample_001","kv001demo001","Medium","No","No","No","No","Too many versions of keys or secrets should not be in use.","Disable older versions of keys and secrets that are no longer required. Go to the Azure Portal > Key Vault > Settings > Keys or Secrets. Select the key or secret that has too many versions, and choose the version that needs to be disabled. Set 'Enabled' attribute as 'No'. For more on the Azure Key Vault service limits, refer: https://docs.microsoft.com/en-us/azure/key-vault/key-vault-service-limits","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_DP_Identify_Roles","Manual","KeyVault","rg_sample_001","kv001demo001","High","No","No","No","No","Key Vault owner must grant minimum required access to keys/secrets based on individual roles (Developer/Operator/Auditor/Security Team)","Key Vault owner must identify different roles that need various levels of access on keyvault keys/secrets and configure them using a least privilege model. Refer: https://docs.microsoft.com/en-us/azure/key-vault/key-vault-secure-your-key-vault","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_DP_Rotate_Key_Periodocally","Manual","KeyVault","rg_sample_001","kv001demo001","Medium","No","No","No","No","Keys/secrets must be rotated periodically","Rotate the keys and secrets at regular intervals. Run command: Update-AzKeyVaultKey -VaultName '{KeyVaultName}' -Name '{KeyName}' -Expires '{ExpiryDate}' -Version '{Version}' to generate new version for key. Run command: Update-AzKeyVaultSecret -VaultName '{KeyVaultName}' -Name '{KeyName}' -Expires '{ExpiryDate}' -Version '{Version}' to generate new version for secret.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_KeyVault_Audit_Review_Logs","Manual","KeyVault","rg_sample_001","kv001demo001","Medium","No","No","No","No","Diagnostic logs for Key Vault must be reviewed periodically","Review diagnostic logs at regular intervals for different operations carried out on keys and secrets. Refer: https://docs.microsoft.com/en-us/azure/log-analytics/log-analytics-azure-key-vault","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_sample_001/providers/Microsoft.KeyVault/vaults/kv001demo001","/rg_sample_001/KeyVault.LOG"
"Azure_VNet_NetSec_Justify_PublicIPs","Passed","VirtualNetwork","rg_spoke_001","spoke001","High","No","No","No","No","Minimize the number of Public IPs (i.e. NICs with PublicIP) on a virtual network","Unutilized Public IP address must be removed from virtual network. For more information visit: https://docs.microsoft.com/en-us/powershell/module/az.network/remove-azpublicipaddress","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_spoke_001/providers/Microsoft.Network/virtualNetworks/spoke001","/rg_spoke_001/VirtualNetwork.LOG"
"Azure_VNet_NetSec_Justify_IPForwarding_for_NICs","Passed","VirtualNetwork","rg_spoke_001","spoke001","High","No","No","No","No","Use of IP Forwarding on any NIC in a virtual network should be scrutinized","Disable IP Forwarding unless it has been reviewed and approved by network security team. Go to Azure Portal --> Navigate to VM NIC (where IP Forwarding is enabled) --> IP Configurations --> IP Forwarding settings --> Click on 'Disabled'.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_spoke_001/providers/Microsoft.Network/virtualNetworks/spoke001","/rg_spoke_001/VirtualNetwork.LOG"
"Azure_VNet_NetSec_Configure_NSG","Failed","VirtualNetwork","rg_spoke_001","spoke001","Medium","No","No","No","No","NSG should be used for subnets in a virtual network to permit traffic only on required inbound/outbound ports. NSGs should not have a rule to allow any-to-any traffic","Configure NSG rules to be as restrictive as possible via: (a) Azure Portal -> Network security groups -> <Your NSG> -> Inbound security rules -> Edit 'Allow' action rules. (b) Azure Portal -> Network security groups. -> <Your NSG> -> Outbound security rules -> Edit 'Allow' action rules.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_spoke_001/providers/Microsoft.Network/virtualNetworks/spoke001","/rg_spoke_001/VirtualNetwork.LOG"
"Azure_VNet_AuthZ_Grant_Min_RBAC_Access","Verify","VirtualNetwork","rg_spoke_001","spoke001","Medium","No","No","No","No","All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)","Remove any excessive privileges granted on the Virtual Network. Run command: Remove-AzRoleAssignment -SignInName '<SignInName>' -Scope '<Scope>' RoleDefinitionName '<RoleDefinitionName>'. Run 'Get-Help Remove-AzRoleAssignment -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_spoke_001/providers/Microsoft.Network/virtualNetworks/spoke001","/rg_spoke_001/VirtualNetwork.LOG"
"Azure_VNet_NetSec_Justify_Gateways","Passed","VirtualNetwork","rg_spoke_001","spoke001","High","No","No","No","No","Presence of any virtual network gateways (GatewayType = VPN/ExpressRoute) in the virtual network must be justified","You can remove virtual network gateways using the Remove-AzVirtualNetworkGateway command (unless their presence has been approved by network security team). Run 'Get-Help Remove-AzVirtualNetworkGateway -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_spoke_001/providers/Microsoft.Network/virtualNetworks/spoke001","/rg_spoke_001/VirtualNetwork.LOG"
"Azure_VNet_NetSec_Justify_Peering","Passed","VirtualNetwork","rg_spoke_001","spoke001","High","No","No","No","No","Use of any virtual network peerings should be justified","You can remove any virtual network peerings using the Remove-AzVirtualNetworkPeering command (unless their presence has been approved by network security team). Run 'Get-Help Remove-AzVirtualNetworkPeering -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_spoke_001/providers/Microsoft.Network/virtualNetworks/spoke001","/rg_spoke_001/VirtualNetwork.LOG"
"Azure_Storage_AuthN_Dont_Allow_Anonymous","Passed","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","High","Yes","No","No","Yes","The Access Type for containers must not be set to 'Anonymous'","Run command 'Set-AzStorageContainerAcl -Name '<ContainerName>' -Permission 'Off' -Context (New-AzStorageContext -StorageAccountName '<StorageAccountName>' -StorageAccountKey '<StorageAccountKey>')'. Run 'Get-Help Set-AzStorageContainerAcl -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_Audit_AuthN_Requests","Failed","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","Medium","No","No","No","Yes","Storage Account must be configured to log and monitor authentication request data","First, run the command '$storageAccount = Get-AzStorageAccount -ResourceGroupName <RGName> -Name <Storage Name> -ErrorAction SilentlyContinue'. Then, run '$storageContext = $storageAccount.Context'. This is the value that you need to supply for -Context in the subsequent commands. Run command 'Set-AzStorageServiceLoggingProperty -ServiceType '<Blob/Queue/Table>' -LoggingOperations 'All' -Context $storageContext -RetentionDays '365' -PassThru'. Run 'Get-Help Set-AzStorageServiceLoggingProperty -full' for more help. Set-AzStorageServiceMetricsProperty -MetricsType 'Hour' -ServiceType '<Blob/Queue/Table/File>' -Context storageContext -MetricsLevel 'ServiceAndApi' -RetentionDays '365' -PassThru. Run 'Get-Help Set-AzStorageServiceMetricsProperty -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_DP_Encrypt_In_Transit","Passed","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","High","Yes","No","No","Yes","HTTPS protocol must be used for accessing Storage Account resources","Run command 'Set-AzStorageAccount -ResourceGroupName <RGName> -Name <StorageAccountName> -EnableHttpsTrafficOnly $true'. Run 'Get-Help Set-AzStorageAccount -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_DP_Restrict_CORS_Access","Passed","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","Medium","No","No","No","No","Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.","Go to Azure Portal --> your Storage service --> Settings --> CORS --> for each of the Storage services  i.e. Blob/File/Table/Queue --> Add --> Provide the specific domain names and other CORS details that should be allowed to make cross-origin calls. Note: No action is needed if you are not using CORS for your service.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthZ_Restrict_Network_Access","Verify","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","Medium","No","No","No","No","Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins","Go to Azure Portal --> your Storage service --> Settings --> Firewalls and virtual networks --> Selected Network. Provide the specific IP address and Virtual Network details that should be allowed to access storage account.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_BCDR_Enable_Soft_Delete","Verify","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","Medium","No","No","No","No","Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots","Refer: https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete to enable soft delete feature on Storage.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthZ_Grant_Min_RBAC_Access","Verify","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","Medium","No","No","No","No","All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)","Remove any excessive privileges granted on the Search service. Run command: Remove-AzRoleAssignment -SignInName '<SignInName>' -Scope '<Scope>' RoleDefinitionName '<RoleDefinitionName>'. Run 'Get-Help Remove-AzRoleAssignment -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthN_Use_AAD_Based_Access","Verify","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","Medium","No","No","No","No","Use AAD-based access for storage account","Refer: https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview, https://docs.microsoft.com/en-us/azure/storage/common/storage-auth-aad-msi ","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthZ_Use_IP_ACL","Manual","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","Medium","No","No","No","No","Use IP-restrictions in SAS tokens to only permit access from intended IP addresses","Restrict storage SAS tokens to specific IP addresses/ranges where possible. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1. Note: In case the IP range is indeterminate (for instance, if the client is a PaaS endpoint), you may need to attest this control.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthZ_Clients_Use_SAS","Manual","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","High","No","No","No","No","End user/client apps should access Storage Account through SAS token only (and not via Storage Account Key)","Do not use Storage Account key directly in apps. Use a SAS token to limit the access based on scope, duration, IPs, etc. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_DP_Rotate_Keys","Manual","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","Medium","No","No","No","No","Storage Account keys must be rotated periodically","Rotate Storage Account keys on a periodic basis. To generated a new key, run command 'New-AzStorageAccountKey -KeyName '<key1/key2>' -Name '<StorageAccountName>' -ResourceGroupName '<RGName>'. Deploy the new key or derived SAS tokens to various clients as appropriate. Run 'Get-Help New-AzStorageAccountKey -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthZ_Allow_Limited_Access_to_Services","Manual","Storage","rg_test_3m27K1eM","sacf6iyfnbch000","High","No","No","No","No","Use Stored Access Policies with least privileges needed to access services in the Storage Account.","Create a SAS token with Stored Access Policy for service access using the minimal required privileges. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1#controlling-a-sas-with-a-stored-access-policy.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch000","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthN_Dont_Allow_Anonymous","Passed","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","High","Yes","No","No","Yes","The Access Type for containers must not be set to 'Anonymous'","Run command 'Set-AzStorageContainerAcl -Name '<ContainerName>' -Permission 'Off' -Context (New-AzStorageContext -StorageAccountName '<StorageAccountName>' -StorageAccountKey '<StorageAccountKey>')'. Run 'Get-Help Set-AzStorageContainerAcl -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_Audit_AuthN_Requests","Failed","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","Medium","No","No","No","Yes","Storage Account must be configured to log and monitor authentication request data","First, run the command '$storageAccount = Get-AzStorageAccount -ResourceGroupName <RGName> -Name <Storage Name> -ErrorAction SilentlyContinue'. Then, run '$storageContext = $storageAccount.Context'. This is the value that you need to supply for -Context in the subsequent commands. Run command 'Set-AzStorageServiceLoggingProperty -ServiceType '<Blob/Queue/Table>' -LoggingOperations 'All' -Context $storageContext -RetentionDays '365' -PassThru'. Run 'Get-Help Set-AzStorageServiceLoggingProperty -full' for more help. Set-AzStorageServiceMetricsProperty -MetricsType 'Hour' -ServiceType '<Blob/Queue/Table/File>' -Context storageContext -MetricsLevel 'ServiceAndApi' -RetentionDays '365' -PassThru. Run 'Get-Help Set-AzStorageServiceMetricsProperty -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_DP_Encrypt_In_Transit","Passed","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","High","Yes","No","No","Yes","HTTPS protocol must be used for accessing Storage Account resources","Run command 'Set-AzStorageAccount -ResourceGroupName <RGName> -Name <StorageAccountName> -EnableHttpsTrafficOnly $true'. Run 'Get-Help Set-AzStorageAccount -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_DP_Restrict_CORS_Access","Passed","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","Medium","No","No","No","No","Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.","Go to Azure Portal --> your Storage service --> Settings --> CORS --> for each of the Storage services  i.e. Blob/File/Table/Queue --> Add --> Provide the specific domain names and other CORS details that should be allowed to make cross-origin calls. Note: No action is needed if you are not using CORS for your service.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthZ_Restrict_Network_Access","Verify","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","Medium","No","No","No","No","Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins","Go to Azure Portal --> your Storage service --> Settings --> Firewalls and virtual networks --> Selected Network. Provide the specific IP address and Virtual Network details that should be allowed to access storage account.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_BCDR_Enable_Soft_Delete","Verify","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","Medium","No","No","No","No","Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots","Refer: https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete to enable soft delete feature on Storage.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthZ_Grant_Min_RBAC_Access","Verify","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","Medium","No","No","No","No","All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)","Remove any excessive privileges granted on the Search service. Run command: Remove-AzRoleAssignment -SignInName '<SignInName>' -Scope '<Scope>' RoleDefinitionName '<RoleDefinitionName>'. Run 'Get-Help Remove-AzRoleAssignment -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthN_Use_AAD_Based_Access","Verify","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","Medium","No","No","No","No","Use AAD-based access for storage account","Refer: https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview, https://docs.microsoft.com/en-us/azure/storage/common/storage-auth-aad-msi ","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthZ_Use_IP_ACL","Manual","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","Medium","No","No","No","No","Use IP-restrictions in SAS tokens to only permit access from intended IP addresses","Restrict storage SAS tokens to specific IP addresses/ranges where possible. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1. Note: In case the IP range is indeterminate (for instance, if the client is a PaaS endpoint), you may need to attest this control.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthZ_Clients_Use_SAS","Manual","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","High","No","No","No","No","End user/client apps should access Storage Account through SAS token only (and not via Storage Account Key)","Do not use Storage Account key directly in apps. Use a SAS token to limit the access based on scope, duration, IPs, etc. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_DP_Rotate_Keys","Manual","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","Medium","No","No","No","No","Storage Account keys must be rotated periodically","Rotate Storage Account keys on a periodic basis. To generated a new key, run command 'New-AzStorageAccountKey -KeyName '<key1/key2>' -Name '<StorageAccountName>' -ResourceGroupName '<RGName>'. Deploy the new key or derived SAS tokens to various clients as appropriate. Run 'Get-Help New-AzStorageAccountKey -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthZ_Allow_Limited_Access_to_Services","Manual","Storage","rg_test_3m27K1eM","sacf6iyfnbch001","High","No","No","No","No","Use Stored Access Policies with least privileges needed to access services in the Storage Account.","Create a SAS token with Stored Access Policy for service access using the minimal required privileges. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1#controlling-a-sas-with-a-stored-access-policy.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_test_3m27K1eM/providers/Microsoft.Storage/storageAccounts/sacf6iyfnbch001","/rg_test_3m27K1eM/Storage.LOG"
"Azure_Storage_AuthN_Dont_Allow_Anonymous","Passed","Storage","tfstate","tfdemo001","High","Yes","No","No","Yes","The Access Type for containers must not be set to 'Anonymous'","Run command 'Set-AzStorageContainerAcl -Name '<ContainerName>' -Permission 'Off' -Context (New-AzStorageContext -StorageAccountName '<StorageAccountName>' -StorageAccountKey '<StorageAccountKey>')'. Run 'Get-Help Set-AzStorageContainerAcl -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
"Azure_Storage_Audit_AuthN_Requests","Failed","Storage","tfstate","tfdemo001","Medium","No","No","No","Yes","Storage Account must be configured to log and monitor authentication request data","First, run the command '$storageAccount = Get-AzStorageAccount -ResourceGroupName <RGName> -Name <Storage Name> -ErrorAction SilentlyContinue'. Then, run '$storageContext = $storageAccount.Context'. This is the value that you need to supply for -Context in the subsequent commands. Run command 'Set-AzStorageServiceLoggingProperty -ServiceType '<Blob/Queue/Table>' -LoggingOperations 'All' -Context $storageContext -RetentionDays '365' -PassThru'. Run 'Get-Help Set-AzStorageServiceLoggingProperty -full' for more help. Set-AzStorageServiceMetricsProperty -MetricsType 'Hour' -ServiceType '<Blob/Queue/Table/File>' -Context storageContext -MetricsLevel 'ServiceAndApi' -RetentionDays '365' -PassThru. Run 'Get-Help Set-AzStorageServiceMetricsProperty -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
"Azure_Storage_DP_Encrypt_In_Transit","Passed","Storage","tfstate","tfdemo001","High","Yes","No","No","Yes","HTTPS protocol must be used for accessing Storage Account resources","Run command 'Set-AzStorageAccount -ResourceGroupName <RGName> -Name <StorageAccountName> -EnableHttpsTrafficOnly $true'. Run 'Get-Help Set-AzStorageAccount -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
"Azure_Storage_DP_Restrict_CORS_Access","Passed","Storage","tfstate","tfdemo001","Medium","No","No","No","No","Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.","Go to Azure Portal --> your Storage service --> Settings --> CORS --> for each of the Storage services  i.e. Blob/File/Table/Queue --> Add --> Provide the specific domain names and other CORS details that should be allowed to make cross-origin calls. Note: No action is needed if you are not using CORS for your service.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
"Azure_Storage_AuthZ_Restrict_Network_Access","Verify","Storage","tfstate","tfdemo001","Medium","No","No","No","No","Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins","Go to Azure Portal --> your Storage service --> Settings --> Firewalls and virtual networks --> Selected Network. Provide the specific IP address and Virtual Network details that should be allowed to access storage account.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
"Azure_Storage_BCDR_Enable_Soft_Delete","Verify","Storage","tfstate","tfdemo001","Medium","No","No","No","No","Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots","Refer: https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete to enable soft delete feature on Storage.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
"Azure_Storage_AuthZ_Grant_Min_RBAC_Access","Verify","Storage","tfstate","tfdemo001","Medium","No","No","No","No","All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)","Remove any excessive privileges granted on the Search service. Run command: Remove-AzRoleAssignment -SignInName '<SignInName>' -Scope '<Scope>' RoleDefinitionName '<RoleDefinitionName>'. Run 'Get-Help Remove-AzRoleAssignment -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
"Azure_Storage_AuthN_Use_AAD_Based_Access","Verify","Storage","tfstate","tfdemo001","Medium","No","No","No","No","Use AAD-based access for storage account","Refer: https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview, https://docs.microsoft.com/en-us/azure/storage/common/storage-auth-aad-msi ","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
"Azure_Storage_AuthZ_Use_IP_ACL","Manual","Storage","tfstate","tfdemo001","Medium","No","No","No","No","Use IP-restrictions in SAS tokens to only permit access from intended IP addresses","Restrict storage SAS tokens to specific IP addresses/ranges where possible. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1. Note: In case the IP range is indeterminate (for instance, if the client is a PaaS endpoint), you may need to attest this control.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
"Azure_Storage_AuthZ_Clients_Use_SAS","Manual","Storage","tfstate","tfdemo001","High","No","No","No","No","End user/client apps should access Storage Account through SAS token only (and not via Storage Account Key)","Do not use Storage Account key directly in apps. Use a SAS token to limit the access based on scope, duration, IPs, etc. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
"Azure_Storage_DP_Rotate_Keys","Manual","Storage","tfstate","tfdemo001","Medium","No","No","No","No","Storage Account keys must be rotated periodically","Rotate Storage Account keys on a periodic basis. To generated a new key, run command 'New-AzStorageAccountKey -KeyName '<key1/key2>' -Name '<StorageAccountName>' -ResourceGroupName '<RGName>'. Deploy the new key or derived SAS tokens to various clients as appropriate. Run 'Get-Help New-AzStorageAccountKey -full' for more help.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
"Azure_Storage_AuthZ_Allow_Limited_Access_to_Services","Manual","Storage","tfstate","tfdemo001","High","No","No","No","No","Use Stored Access Policies with least privileges needed to access services in the Storage Account.","Create a SAS token with Stored Access Policy for service access using the minimal required privileges. Refer: https://docs.microsoft.com/en-us/azure/storage/storage-dotnet-shared-access-signature-part-1#controlling-a-sas-with-a-stored-access-policy.","/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/tfstate/providers/Microsoft.Storage/storageAccounts/tfdemo001","/tfstate/Storage.LOG"
