================================================================================
Starting analysis: [FeatureName: VirtualNetwork] [ResourceGroupName: rg_spoke_001] [ResourceName: spoke001] 
--------------------------------------------------------------------------------
================================================================================
[Azure_VNet_NetSec_Justify_PublicIPs]: Minimize the number of Public IPs (i.e. NICs with PublicIP) on a virtual network
--------------------------------------------------------------------------------
01/23/2020 22:05:21-Checking: [VirtualNetwork]-[Minimize the number of Public IPs (i.e. NICs with PublicIP) on a virtual network] for resource [spoke001]
Analyzing all the NICs configured in the VNet
No Public IP is configured in any NIC on the Vnet
--------------------------------------------------------------------------------
**Passed**: [VirtualNetwork]-[Minimize the number of Public IPs (i.e. NICs with PublicIP) on a virtual network] for resource: [spoke001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VNet_NetSec_Justify_IPForwarding_for_NICs]: Use of IP Forwarding on any NIC in a virtual network should be scrutinized
--------------------------------------------------------------------------------
01/23/2020 22:05:21-Checking: [VirtualNetwork]-[Use of IP Forwarding on any NIC in a virtual network should be scrutinized] for resource [spoke001]
There are no NICs with EnableIPForwarding turned on the VNet
--------------------------------------------------------------------------------
**Passed**: [VirtualNetwork]-[Use of IP Forwarding on any NIC in a virtual network should be scrutinized] for resource: [spoke001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VNet_NetSec_Dont_Use_NSGs_on_GatewaySubnet]: There must not be any NSGs on the gateway subnet of a virtual network
--------------------------------------------------------------------------------
01/23/2020 22:05:21-Checking: [VirtualNetwork]-[There must not be any NSGs on the gateway subnet of a virtual network] for resource [spoke001]
--------------------------------------------------------------------------------
**Disabled**: [VirtualNetwork]-[There must not be any NSGs on the gateway subnet of a virtual network]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VNet_NetSec_Configure_NSG]: NSG should be used for subnets in a virtual network to permit traffic only on required inbound/outbound ports. NSGs should not have a rule to allow any-to-any traffic
--------------------------------------------------------------------------------
01/23/2020 22:05:21-Checking: [VirtualNetwork]-[NSG should be used for subnets in a virtual network to permit traffic only on required inbound/outbound ports. NSGs should not have a rule to allow any-to-any traffic] for resource [spoke001]
NSG is not configured for below subnet(s) of VNet
@(
    @{
        "Id" = "/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_spoke_001/providers/Microsoft.Network/virtualNetworks/spoke001/subnets/default"; 
        "Name" = "default"
    }, 
    @{
        "Id" = "/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_spoke_001/providers/Microsoft.Network/virtualNetworks/spoke001/subnets/iaas001"; 
        "Name" = "iaas001"
    }, 
    @{
        "Id" = "/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_spoke_001/providers/Microsoft.Network/virtualNetworks/spoke001/subnets/privatedatabricks001"; 
        "Name" = "privatedatabricks001"
    }, 
    @{
        "Id" = "/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourceGroups/rg_spoke_001/providers/Microsoft.Network/virtualNetworks/spoke001/subnets/AzureBastionSubnet"; 
        "Name" = "AzureBastionSubnet"
    }
)
--------------------------------------------------------------------------------
**Failed**: [VirtualNetwork]-[NSG should be used for subnets in a virtual network to permit traffic only on required inbound/outbound ports. NSGs should not have a rule to allow any-to-any traffic] for resource: [spoke001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VNet_AuthZ_Grant_Min_RBAC_Access]: All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)
--------------------------------------------------------------------------------
01/23/2020 22:05:22-Checking: [VirtualNetwork]-[All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)] for resource [spoke001]
No identities have been explicitly provided with RBAC access to resource - [spoke001]
Note: 4 identities (ServicePrincipal: 3, User: 1) have inherited RBAC access to resource. It's good practice to keep the RBAC access to minimum.
--------------------------------------------------------------------------------
**Verify**: [VirtualNetwork]-[All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)] for resource: [spoke001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VNet_NetSec_Justify_Gateways]: Presence of any virtual network gateways (GatewayType = VPN/ExpressRoute) in the virtual network must be justified
--------------------------------------------------------------------------------
01/23/2020 22:05:24-Checking: [VirtualNetwork]-[Presence of any virtual network gateways (GatewayType = VPN/ExpressRoute) in the virtual network must be justified] for resource [spoke001]
No gateways found in VNet
--------------------------------------------------------------------------------
**Passed**: [VirtualNetwork]-[Presence of any virtual network gateways (GatewayType = VPN/ExpressRoute) in the virtual network must be justified] for resource: [spoke001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VNet_NetSec_Justify_Peering]: Use of any virtual network peerings should be justified
--------------------------------------------------------------------------------
01/23/2020 22:05:24-Checking: [VirtualNetwork]-[Use of any virtual network peerings should be justified] for resource [spoke001]
No VNet peering found on VNet
--------------------------------------------------------------------------------
**Passed**: [VirtualNetwork]-[Use of any virtual network peerings should be justified] for resource: [spoke001]
--------------------------------------------------------------------------------
================================================================================ 

--------------------------------------------------------------------------------
Completed analysis: [FeatureName: VirtualNetwork] [ResourceGroupName: rg_spoke_001] [ResourceName: spoke001] 
================================================================================
################################################################################
