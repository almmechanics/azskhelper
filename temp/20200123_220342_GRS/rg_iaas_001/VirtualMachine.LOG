================================================================================
Starting analysis: [FeatureName: VirtualMachine] [ResourceGroupName: rg_iaas_001] [ResourceName: vm001001] 
--------------------------------------------------------------------------------
================================================================================
[Azure_VirtualMachine_Deploy_Latest_OS_Version]: Virtual Machine should have latest OS version installed
--------------------------------------------------------------------------------
01/23/2020 22:04:46-Checking: [VirtualMachine]-[Virtual Machine should have latest OS version installed] for resource [vm001001]
Verify if you are using recommended OS Sku as per Org security policy
@{
    "Offer" = "UbuntuServer"; 
    "OSType" = "Linux"; 
    "Sku" = "16.04.0-LTS"
}
--------------------------------------------------------------------------------
**Verify**: [VirtualMachine]-[Virtual Machine should have latest OS version installed] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_SI_Enable_Antimalware]: Antimalware must be enabled with real time protection on Virtual Machine
--------------------------------------------------------------------------------
01/23/2020 22:04:46-Checking: [VirtualMachine]-[Antimalware must be enabled with real time protection on Virtual Machine] for resource [vm001001]
We are not able to check Security Center workspace status. Please validate VM antimalware status manually.
--------------------------------------------------------------------------------
**Manual**: [VirtualMachine]-[Antimalware must be enabled with real time protection on Virtual Machine] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_Config_Enable_NSG]: NSG must be configured for Virtual Machine
--------------------------------------------------------------------------------
01/23/2020 22:04:46-Checking: [VirtualMachine]-[NSG must be configured for Virtual Machine] for resource [vm001001]
No NSG was found on Virtual Machine subnet or NIC.
--------------------------------------------------------------------------------
**Failed**: [VirtualMachine]-[NSG must be configured for Virtual Machine] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_NetSec_Justify_PublicIPs]: Public IPs on a Virtual Machine should be carefully reviewed
--------------------------------------------------------------------------------
01/23/2020 22:04:47-Checking: [VirtualMachine]-[Public IPs on a Virtual Machine should be carefully reviewed] for resource [vm001001]
No Public IP is associated with Virtual Machine
--------------------------------------------------------------------------------
**Passed**: [VirtualMachine]-[Public IPs on a Virtual Machine should be carefully reviewed] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_SI_ASC_OS_Vulnerabilities]: Virtual Machine must be in a healthy state in Azure Security Center
--------------------------------------------------------------------------------
01/23/2020 22:04:47-Checking: [VirtualMachine]-[Virtual Machine must be in a healthy state in Azure Security Center] for resource [vm001001]
VM patch status details:
@{
    "assessmentDetails" = @(); 
    "assessmentKey" = "181ac480-f7c4-544b-9865-11b8ffe87f47"; 
    "assessmentResult" = "None"; 
    "category" = "Compute"; 
    "policyDefinitionId" = "/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15"; 
    "policyName" = "Vulnerabilities in security configuration on your machines should be remediated"
}
Unable to validate baseline status from workspace.Please verify.
Details of failing baseline rules can be obtained from Log Analytics workspace :
The following query can be used to obtain failing baseline rules :  
SecurityBaseline | where TimeGenerated >ago(1d) | where ResourceId =="/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourcegroups/rg_iaas_001/providers/microsoft.compute/virtualmachines/vm001001" | summarize arg_max(TimeGenerated,*)by Description| where AnalyzeResult == "Failed" 
--------------------------------------------------------------------------------
**Verify**: [VirtualMachine]-[Virtual Machine must be in a healthy state in Azure Security Center] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_SI_Missing_OS_Patches]: Virtual Machine must have all the required OS patches installed.
--------------------------------------------------------------------------------
01/23/2020 22:04:48-Checking: [VirtualMachine]-[Virtual Machine must have all the required OS patches installed.] for resource [vm001001]
VM patch status details:
@{
    "assessmentDetails" = @(); 
    "assessmentKey" = "4ab6e3c5-74dd-8b35-9ab9-f61b30875b27"; 
    "assessmentResult" = "None"; 
    "category" = "Compute"; 
    "policyDefinitionId" = "/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60"; 
    "policyName" = "System updates should be installed on your machines"
}
Details of missing patches can be obtained from the following workspace
Workspace : 
The following query can be used to obtain patch details:
Query : 
Update | where TimeGenerated >ago(1d) |where OSType == "Linux" and UpdateState =~ "Needed" and iff(isnotnull(toint(Optional)), Optional == false, Optional == "false") == true and iff(isnotnull(toint(Approved)), Approved != false, Approved != "false") == true and (Classification == "Security Updates" or Classification == "Critical Updates") and ResourceId =="/subscriptions/552cae66-87bd-4c0b-af77-fb2578fb7905/resourcegroups/rg_iaas_001/providers/microsoft.compute/virtualmachines/vm001001"| summarize AggregatedValue =dcount(UpdateID) by UpdateID,Title |limit  1000000000 
--------------------------------------------------------------------------------
**Verify**: [VirtualMachine]-[Virtual Machine must have all the required OS patches installed.] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_SI_ASC_Recommendations]: Virtual Machine must implement all the flagged ASC recommendations.
--------------------------------------------------------------------------------
01/23/2020 22:04:48-Checking: [VirtualMachine]-[Virtual Machine must implement all the flagged ASC recommendations.] for resource [vm001001]
--------------------------------------------------------------------------------
**Passed**: [VirtualMachine]-[Virtual Machine must implement all the flagged ASC recommendations.] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_Audit_Enable_Diagnostics]: Diagnostics (IaaSDiagnostics extension on Windows; LinuxDiagnostic extension on Linux) must be enabled on Virtual Machine
--------------------------------------------------------------------------------
01/23/2020 22:04:50-Checking: [VirtualMachine]-[Diagnostics (IaaSDiagnostics extension on Windows; LinuxDiagnostic extension on Linux) must be enabled on Virtual Machine] for resource [vm001001]
'LinuxDiagnostic' extension is either not installed or provisioning failed on Virtual Machine
--------------------------------------------------------------------------------
**Failed**: [VirtualMachine]-[Diagnostics (IaaSDiagnostics extension on Windows; LinuxDiagnostic extension on Linux) must be enabled on Virtual Machine] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_NetSec_Dont_Open_Management_Ports]: Do not leave management ports open on Virtual Machines
--------------------------------------------------------------------------------
01/23/2020 22:04:50-Checking: [VirtualMachine]-[Do not leave management ports open on Virtual Machines] for resource [vm001001]
Checking for Virtual Machine management ports
@(
    @{
        "Name" = "RDP"; 
        "Port" = 3389
    }, 
    @{
        "Name" = "SSH"; 
        "Port" = 22
    }
)
Verify if NSG is attached to VM.
--------------------------------------------------------------------------------
**Failed**: [VirtualMachine]-[Do not leave management ports open on Virtual Machines] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_SI_Enable_Vuln_Solution]: Vulnerability assessment solution should be installed on VM
--------------------------------------------------------------------------------
01/23/2020 22:05:00-Checking: [VirtualMachine]-[Vulnerability assessment solution should be installed on VM] for resource [vm001001]
Required vulnerability assessment solution 'QualysAgentLinux' is not present in VM.
--------------------------------------------------------------------------------
**Failed**: [VirtualMachine]-[Vulnerability assessment solution should be installed on VM] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_SI_Deploy_GuestConfig_Extension]: Guest Configuration extension must be deployed to the VM using Azure Policy assignment
--------------------------------------------------------------------------------
01/23/2020 22:05:00-Checking: [VirtualMachine]-[Guest Configuration extension must be deployed to the VM using Azure Policy assignment] for resource [vm001001]
Required guest configuration extension 'ConfigurationForLinux' is not present in VM.
The VM does not have a SystemAssigned managed identity
--------------------------------------------------------------------------------
**Failed**: [VirtualMachine]-[Guest Configuration extension must be deployed to the VM using Azure Policy assignment] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_SI_GuestConfig_Policy_Health]: Guest config extension should report compliant status for all in-guest policies.
--------------------------------------------------------------------------------
01/23/2020 22:05:00-Checking: [VirtualMachine]-[Guest config extension should report compliant status for all in-guest policies.] for resource [vm001001]
No guest configuration policy assignment has been found for this resource.
--------------------------------------------------------------------------------
**Passed**: [VirtualMachine]-[Guest config extension should report compliant status for all in-guest policies.] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_VirtualMachine_SI_Deploy_Required_Extensions]: All VM extensions required as per your Org policy must be deployed to the VM
--------------------------------------------------------------------------------
01/23/2020 22:05:02-Checking: [VirtualMachine]-[All VM extensions required as per your Org policy must be deployed to the VM] for resource [vm001001]
Following required extensions are not present in VM:
@(
    @{
        "ExtensionType" = "ConfigurationForLinux"; 
        "Publisher" = "Microsoft.GuestConfiguration"
    }, 
    @{
        "ExtensionType" = "QualysAgentLinux"; 
        "Publisher" = "Qualys"
    }, 
    @{
        "ExtensionType" = "LinuxDiagnostic"; 
        "Publisher" = "Microsoft.Azure.Diagnostics"
    }, 
    @{
        "ExtensionType" = "OmsAgentForLinux"; 
        "Publisher" = "Microsoft.EnterpriseCloud.Monitoring"
    }
)
--------------------------------------------------------------------------------
**Failed**: [VirtualMachine]-[All VM extensions required as per your Org policy must be deployed to the VM] for resource: [vm001001]
--------------------------------------------------------------------------------
================================================================================ 

--------------------------------------------------------------------------------
Completed analysis: [FeatureName: VirtualMachine] [ResourceGroupName: rg_iaas_001] [ResourceName: vm001001] 
================================================================================
################################################################################
