================================================================================
Starting analysis: [FeatureName: Storage] [ResourceGroupName: cost_mgmt_rg] [ResourceName: almcostmgmt] 
--------------------------------------------------------------------------------
================================================================================
[Azure_Storage_AuthN_Dont_Allow_Anonymous]: The Access Type for containers must not be set to 'Anonymous'
--------------------------------------------------------------------------------
01/23/2020 22:04:16-Checking: [Storage]-[The Access Type for containers must not be set to 'Anonymous'] for resource [almcostmgmt]
No containers were found that have public (anonymous) access in this storage account.
--------------------------------------------------------------------------------
**Passed**: [Storage]-[The Access Type for containers must not be set to 'Anonymous'] for resource: [almcostmgmt]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_Audit_Issue_Alert_AuthN_Req]: Alert rules must be configured for tracking anonymous activity
--------------------------------------------------------------------------------
01/23/2020 22:04:16-Checking: [Storage]-[Alert rules must be configured for tracking anonymous activity] for resource [almcostmgmt]
--------------------------------------------------------------------------------
**Disabled**: [Storage]-[Alert rules must be configured for tracking anonymous activity]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_Audit_AuthN_Requests]: Storage Account must be configured to log and monitor authentication request data
--------------------------------------------------------------------------------
01/23/2020 22:04:16-Checking: [Storage]-[Storage Account must be configured to log and monitor authentication request data] for resource [almcostmgmt]
Diagnostics settings(blob logs) is either disabled OR not retaining logs for at least 365 days for service type - [blob]
Diagnostics settings(queue logs) is either disabled OR not retaining logs for at least 365 days for service type - [queue]
Diagnostics settings(table logs) is either disabled OR not retaining logs for at least 365 days for service type - [table]
Diagnostics settings(blob aggregate metrics, blob per API metrics) is either disabled OR not retaining logs for at least 365 days for service type - [blob]
Diagnostics settings(file aggregate metrics, file per API metrics) is either disabled OR not retaining logs for at least 365 days for service type - [file]
Diagnostics settings(queue aggregate metrics, queue per API metrics) is either disabled OR not retaining logs for at least 365 days for service type - [queue]
Diagnostics settings(table aggregate metrics, table per API metrics) is either disabled OR not retaining logs for at least 365 days for service type - [table]
--------------------------------------------------------------------------------
**Failed**: [Storage]-[Storage Account must be configured to log and monitor authentication request data] for resource: [almcostmgmt]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_DP_Encrypt_In_Transit]: HTTPS protocol must be used for accessing Storage Account resources
--------------------------------------------------------------------------------
01/23/2020 22:04:18-Checking: [Storage]-[HTTPS protocol must be used for accessing Storage Account resources] for resource [almcostmgmt]
Storage secure transfer is not enabled
--------------------------------------------------------------------------------
**Failed**: [Storage]-[HTTPS protocol must be used for accessing Storage Account resources] for resource: [almcostmgmt]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_DP_Restrict_CORS_Access]: Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.
--------------------------------------------------------------------------------
01/23/2020 22:04:19-Checking: [Storage]-[Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.] for resource [almcostmgmt]
The CORS feature has not been enabled on this storage account.
--------------------------------------------------------------------------------
**Passed**: [Storage]-[Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.] for resource: [almcostmgmt]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_AuthZ_Restrict_Network_Access]: Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins
--------------------------------------------------------------------------------
01/23/2020 22:04:19-Checking: [Storage]-[Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins] for resource [almcostmgmt]
No Firewall and Virtual Network restrictions are defined for this storage
--------------------------------------------------------------------------------
**Verify**: [Storage]-[Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins] for resource: [almcostmgmt]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_BCDR_Enable_Soft_Delete]: Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots
--------------------------------------------------------------------------------
01/23/2020 22:04:20-Checking: [Storage]-[Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots] for resource [almcostmgmt]
Soft delete is disabled for this Storage account
--------------------------------------------------------------------------------
**Verify**: [Storage]-[Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots] for resource: [almcostmgmt]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_AuthZ_Grant_Min_RBAC_Access]: All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)
--------------------------------------------------------------------------------
01/23/2020 22:04:20-Checking: [Storage]-[All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)] for resource [almcostmgmt]
No identities have been explicitly provided with RBAC access to resource - [almcostmgmt]
Note: 4 identities (ServicePrincipal: 3, User: 1) have inherited RBAC access to resource. It's good practice to keep the RBAC access to minimum.
--------------------------------------------------------------------------------
**Verify**: [Storage]-[All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)] for resource: [almcostmgmt]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_AuthN_Use_AAD_Based_Access]: Use AAD-based access for storage account
--------------------------------------------------------------------------------
01/23/2020 22:04:22-Checking: [Storage]-[Use AAD-based access for storage account] for resource [almcostmgmt]
No SPN/MSI/User has been explicitly provided with Storage RBAC access to this resource
--------------------------------------------------------------------------------
**Verify**: [Storage]-[Use AAD-based access for storage account] for resource: [almcostmgmt]
--------------------------------------------------------------------------------
================================================================================ 

--------------------------------------------------------------------------------
Completed analysis: [FeatureName: Storage] [ResourceGroupName: cost_mgmt_rg] [ResourceName: almcostmgmt] 
================================================================================
################################################################################
================================================================================
Starting analysis: [FeatureName: Storage] [ResourceGroupName: cost_mgmt_rg] [ResourceName: almcostmgmt2] 
--------------------------------------------------------------------------------
================================================================================
[Azure_Storage_AuthN_Dont_Allow_Anonymous]: The Access Type for containers must not be set to 'Anonymous'
--------------------------------------------------------------------------------
01/23/2020 22:04:25-Checking: [Storage]-[The Access Type for containers must not be set to 'Anonymous'] for resource [almcostmgmt2]
No containers were found that have public (anonymous) access in this storage account.
--------------------------------------------------------------------------------
**Passed**: [Storage]-[The Access Type for containers must not be set to 'Anonymous'] for resource: [almcostmgmt2]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_Audit_Issue_Alert_AuthN_Req]: Alert rules must be configured for tracking anonymous activity
--------------------------------------------------------------------------------
01/23/2020 22:04:25-Checking: [Storage]-[Alert rules must be configured for tracking anonymous activity] for resource [almcostmgmt2]
--------------------------------------------------------------------------------
**Disabled**: [Storage]-[Alert rules must be configured for tracking anonymous activity]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_Audit_AuthN_Requests]: Storage Account must be configured to log and monitor authentication request data
--------------------------------------------------------------------------------
01/23/2020 22:04:25-Checking: [Storage]-[Storage Account must be configured to log and monitor authentication request data] for resource [almcostmgmt2]
Diagnostics settings(blob logs) is either disabled OR not retaining logs for at least 365 days for service type - [blob]
Diagnostics settings(queue logs) is either disabled OR not retaining logs for at least 365 days for service type - [queue]
Diagnostics settings(table logs) is either disabled OR not retaining logs for at least 365 days for service type - [table]
Diagnostics settings(blob aggregate metrics, blob per API metrics) is either disabled OR not retaining logs for at least 365 days for service type - [blob]
Diagnostics settings(file aggregate metrics, file per API metrics) is either disabled OR not retaining logs for at least 365 days for service type - [file]
Diagnostics settings(queue aggregate metrics, queue per API metrics) is either disabled OR not retaining logs for at least 365 days for service type - [queue]
Diagnostics settings(table aggregate metrics, table per API metrics) is either disabled OR not retaining logs for at least 365 days for service type - [table]
--------------------------------------------------------------------------------
**Failed**: [Storage]-[Storage Account must be configured to log and monitor authentication request data] for resource: [almcostmgmt2]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_DP_Encrypt_In_Transit]: HTTPS protocol must be used for accessing Storage Account resources
--------------------------------------------------------------------------------
01/23/2020 22:04:26-Checking: [Storage]-[HTTPS protocol must be used for accessing Storage Account resources] for resource [almcostmgmt2]
Storage secure transfer is not enabled
--------------------------------------------------------------------------------
**Failed**: [Storage]-[HTTPS protocol must be used for accessing Storage Account resources] for resource: [almcostmgmt2]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_DP_Restrict_CORS_Access]: Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.
--------------------------------------------------------------------------------
01/23/2020 22:04:26-Checking: [Storage]-[Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.] for resource [almcostmgmt2]
The CORS feature has not been enabled on this storage account.
--------------------------------------------------------------------------------
**Passed**: [Storage]-[Ensure that CORS access is granted to a minimal set of trusted origins and only required verbs are supported.] for resource: [almcostmgmt2]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_AuthZ_Restrict_Network_Access]: Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins
--------------------------------------------------------------------------------
01/23/2020 22:04:27-Checking: [Storage]-[Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins] for resource [almcostmgmt2]
No Firewall and Virtual Network restrictions are defined for this storage
--------------------------------------------------------------------------------
**Verify**: [Storage]-[Ensure that Firewall and Virtual Network access is granted to a minimal set of trusted origins] for resource: [almcostmgmt2]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_BCDR_Enable_Soft_Delete]: Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots
--------------------------------------------------------------------------------
01/23/2020 22:04:27-Checking: [Storage]-[Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots] for resource [almcostmgmt2]
Soft delete is disabled for this Storage account
--------------------------------------------------------------------------------
**Verify**: [Storage]-[Soft delete should be enabled to allow recovery of deleted blobs or blob snapshots] for resource: [almcostmgmt2]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_AuthZ_Grant_Min_RBAC_Access]: All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)
--------------------------------------------------------------------------------
01/23/2020 22:04:27-Checking: [Storage]-[All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)] for resource [almcostmgmt2]
No identities have been explicitly provided with RBAC access to resource - [almcostmgmt2]
Note: 4 identities (ServicePrincipal: 3, User: 1) have inherited RBAC access to resource. It's good practice to keep the RBAC access to minimum.
--------------------------------------------------------------------------------
**Verify**: [Storage]-[All users/identities must be granted minimum required permissions using Role Based Access Control (RBAC)] for resource: [almcostmgmt2]
--------------------------------------------------------------------------------
================================================================================ 

================================================================================
[Azure_Storage_AuthN_Use_AAD_Based_Access]: Use AAD-based access for storage account
--------------------------------------------------------------------------------
01/23/2020 22:04:28-Checking: [Storage]-[Use AAD-based access for storage account] for resource [almcostmgmt2]
No SPN/MSI/User has been explicitly provided with Storage RBAC access to this resource
--------------------------------------------------------------------------------
**Verify**: [Storage]-[Use AAD-based access for storage account] for resource: [almcostmgmt2]
--------------------------------------------------------------------------------
================================================================================ 

--------------------------------------------------------------------------------
Completed analysis: [FeatureName: Storage] [ResourceGroupName: cost_mgmt_rg] [ResourceName: almcostmgmt2] 
================================================================================
################################################################################
